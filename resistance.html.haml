%html{:lang => 'ja'}
  %head
    %meta{:charset => 'UTF-8'}
  %body
    - colors = ['black','brown','red','orange','yellow','green','blue','purple','gray','white','gold','silver','none']

    - 4.times do |t|
      %div{:id => "resistance#{t + 1}", :class => "colors"}
        %div{:class => "code space"}
        - ci = (t == 0) ? (1..9) : (t != 3) ? (0..9) : [1,2,10,11,12]
        - ci.each do |i|
          %div{:class => "code #{colors[i]}", :data => i}
        %div{:class => "code space"}

    :javascript
      var r1 = document.getElementById('resistance1');
      var r2 = document.getElementById('resistance2');
      var r3 = document.getElementById('resistance3');
      var r4 = document.getElementById('resistance4');

      window.onload = setResistance;
      r1.onscroll = getResistance;
      r2.onscroll = getResistance;
      r3.onscroll = getResistance;

      function getResistance() {
        var re,sis,tan,ce;
        re = scrollIndex(r1) + 1;
        sis = scrollIndex(r2);
        tan = scrollIndex(r3);
        ce = scrollIndex(r4);

        var resistance = (re*10 + sis) *  Math.pow(10,tan);
        var deniminations = ['','k','M','G'];
        for(var i=0; i<deniminations.length; i++) {
          if(resistance < Math.pow(10, (i + 1)*3)) { break; }
        }
        resistance /= Math.pow(10, i*3);
        resistance = resistance + deniminations[i];
        location.hash = resistance;
      }

      function scrollIndex(element) {
        return Math.round( element.scrollTop / (element.scrollHeight - element.offsetHeight ) * (element.childElementCount - 3) );
      }

      function setResistance() {
        var resistance = location.hash.replace('#','');
        if (!(/^[1-9]\.?[0-9]?[kMG]?$/i).test(resistance)) return;

        var deniminations = ['k','M','G'];
        var zeros = '';
        for(var i=0; i<deniminations.length; i++) {
          var reg = new RegExp(deniminations[i], 'i');
          if(reg.test(resistance)) {
            resistance = resistance.replace(reg, '') * Math.pow(1000, i+1);
            break;
          }
        }

        for(var i=0; resistance > 10; i++) { resistance /= 10; }
        var digits = i - 1;
        var dig1 = Math.floor(resistance);
        var dig2 = Math.round((resistance - dig1) * 10);
        var dig4 = 2;

        scrollTo(r1, dig1 - 1);
        scrollTo(r2, dig2);
        scrollTo(r3, digits);
        scrollTo(r4, dig4);
      }

      function scrollTo(element, index) {
        element.scrollTop = index * (element.scrollHeight - element.offsetHeight ) / (element.childElementCount - 3);
      }

    :css
      body{ margin: 0; }
      .colors{
        width: 25%;
        height: 100%;
        float: left;
        overflow: scroll;
      }
      .code{
        width: 100%;
        height: 80%;
      }
      .space{ height: 10%; }
      .black{ background-color : #202020 }
      .brown{ background-color : #AF482B }
      .red{ background-color : #E8302B }
      .orange{ background-color : #E9952F }
      .yellow{ background-color : #F5EE29 }
      .green{ background-color : #24B324 }
      .blue{ background-color : #1B8AC1 }
      .purple{ background-color : #7064AA }
      .gray{ background-color : #8E8E8E }
      .white{ background-color : #F0F0F0 }
      .gold{ background-color : #E4DA82 }
      .silver{ background-color : #C1CBD9 }
      .none{ background-color : #A3E4E1 }